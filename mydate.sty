\NeedsTeXFormat{LaTeX2e}[1999/01/01]
\ProvidesPackage{mydate}[2011/03/28]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Declare package options %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Language options
\newif\if@myenglish \@myenglishfalse
\DeclareOption{myenglish}{\@myenglishtrue}
\newif\if@myfrancais \@myfrancaisfalse
\DeclareOption{myfrancais}{\@myfrancaistrue}
% In case of unknown options
\DeclareOption*{%
	\PackageWarning{mydate}{Unknown option `\CurrentOption'}%
}

\ProcessOptions

%% Options to pass to packages
\if@myfrancais
	\PassOptionsToPackage{french}{isodate}
\fi
\if@myenglish
	\PassOptionsToPackage{english}{isodate}
\fi

%% Packages to call
\RequirePackage{etoolbox}
\RequirePackage{xkeyval}
\RequirePackage{xspace}
\RequirePackage[iso,printdayon]{isodate}

%%%%%%%%%%%%%%%%%%
%% New commands %%
%%%%%%%%%%%%%%%%%%
%% Define a key about the style
% The styles should be one of the following value:
% - resume -> 28/03/2011
% - short -> 28th march 2011
% - long -> monday, 28th march 2011 (is not working with 'isodate' !)
\define@choicekey[my]{date}{datestyle}[\mydate@uservalue\mydate@numin]{resume,short,long}[short]{\def\mydate@style{#1}}
%% Define a key about the separator in a 'resume' style date
\define@key[my]{date}{datesep}[-]{\def\mydate@sep{#1}}
\setkeys[my]{date}{datesep={-}}
%% Command \Date insere a date with different styles
\newcommand{\mydate}[2][]{%
	\setkeys[my]{date}{#1}%
	\ifcase\mydate@numin\relax%
		{\isodash{\mydate@sep}\isodate\printdate{#2}\xspace}%
	\or%
		{\origdate\printdayon\printdate{#2}\xspace}%
	\or%
		{\origdate\printdayon\printdate{#2}\xspace}%
	\fi%
	}
% End of package
\endinput
